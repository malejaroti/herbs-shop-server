generator client {
  provider = "prisma-client-js"
  output   = "../src/generated/prisma"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

model User {
  id        String   @id @default(cuid())
  firstName String
  lastName  String
  email     String   @unique
  password  String
  role      Role     @default(CUSTOMER)
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt
}

model Product {
  id             String            @id @default(cuid())
  name           String
  slug           String            @unique
  latinName      String?
  bulkGrams      Int               @default(0)
  reorderAtGrams Int?
  descriptionMd  String?
  originCountry  String?
  organicCert    String?
  active         Boolean           @default(true)
  categories     ProductCategory[]
  images         Json?
  createdAt      DateTime          @default(now())
  updatedAt      DateTime          @updatedAt
  variants       ProductVariant[]
}

model ProductVariant {
  id            String   @id @default(cuid())
  productId     String
  sku           String   @unique
  name          String
  packSizeGrams Int
  price         Decimal  @db.Decimal(8,2)
  currency      Currency @default(EUR)
  taxClass      TaxClass @default(REDUCED)
  active        Boolean  @default(true)
  product       Product  @relation(fields: [productId], references: [id], onDelete: Cascade)

  @@unique([productId, name])
}

enum Role {
  ADMIN    @map("admin")
  CUSTOMER @map("customer")
}

enum Currency {
  EUR
}

enum ProductCategory {
  HERBS
  SPICES
}

enum TaxClass {
  STANDARD
  REDUCED
  EXEMPT
}
